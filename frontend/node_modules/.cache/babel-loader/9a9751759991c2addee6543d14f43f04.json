{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import api from\"./services/api\";import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Tasks(_ref){let{user:propUser,onLogout}=_ref;const[task,setTask]=useState(\"\");const[description,setDescription]=useState(\"\");const[tasks,setTasks]=useState([]);const[editingId,setEditingId]=useState(null);const[editText,setEditText]=useState(\"\");const token=localStorage.getItem(\"token\");// Ensure user is available even if prop is lost\nconst user=propUser!==null&&propUser!==void 0&&propUser.id?propUser:JSON.parse(localStorage.getItem(\"user\"));useEffect(()=>{if(!(user!==null&&user!==void 0&&user.id)){console.warn(\"User ID missing — redirecting to login\");onLogout();}},[user,onLogout]);const fetchTasks=async()=>{try{const res=await api.get(\"/tasks\",{headers:{Authorization:\"Bearer \".concat(token)}});setTasks(res.data);}catch(err){console.error(\"Failed to fetch tasks:\",err);}};const createTask=async()=>{if(!(user!==null&&user!==void 0&&user.id)||!task.trim()){alert(\"User ID and task title are required\");console.log(\"Debug:\",{userId:user===null||user===void 0?void 0:user.id,task});return;}const payload={user_id:user.id,title:task,description:description||\"\",status:\"pending\"};try{const res=await api.post(\"/tasks\",payload,{headers:{Authorization:\"Bearer \".concat(token)}});setTasks([...tasks,res.data]);setTask(\"\");setDescription(\"\");}catch(err){console.error(\"Failed to create task:\",err);alert(\"❌ Task creation failed\");}};const deleteTask=async id=>{try{await api.delete(\"/tasks/\".concat(id),{headers:{Authorization:\"Bearer \".concat(token)}});setTasks(tasks.filter(t=>t.id!==id));}catch(err){console.error(\"Failed to delete task:\",err);}};const startEditing=task=>{setEditingId(task.id);setEditText(task.title);};const cancelEditing=()=>{setEditingId(null);setEditText(\"\");};const updateTask=async()=>{try{const res=await api.put(\"/tasks/\".concat(editingId),{title:editText},{headers:{Authorization:\"Bearer \".concat(token)}});setTasks(tasks.map(t=>t.id===editingId?res.data:t));cancelEditing();}catch(err){console.error(\"Failed to update task:\",err);}};useEffect(()=>{fetchTasks();},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"2rem\"},children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Welcome, \",(user===null||user===void 0?void 0:user.name)||\"User\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"1rem\"},children:[/*#__PURE__*/_jsx(\"input\",{value:task,onChange:e=>setTask(e.target.value),placeholder:\"New task\",style:{padding:\"0.5rem\",width:\"300px\"}}),/*#__PURE__*/_jsx(\"input\",{value:description,onChange:e=>setDescription(e.target.value),placeholder:\"Description\",style:{padding:\"0.5rem\",width:\"300px\",marginLeft:\"1rem\"}}),/*#__PURE__*/_jsx(\"button\",{onClick:createTask,style:{marginLeft:\"1rem\"},children:\"Add Task\"})]}),/*#__PURE__*/_jsx(\"ul\",{children:tasks.map(t=>/*#__PURE__*/_jsx(\"li\",{style:{marginBottom:\"0.5rem\"},children:editingId===t.id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{value:editText,onChange:e=>setEditText(e.target.value),style:{padding:\"0.3rem\",width:\"250px\"}}),/*#__PURE__*/_jsx(\"button\",{onClick:updateTask,style:{marginLeft:\"0.5rem\"},children:\"Save\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEditing,style:{marginLeft:\"0.5rem\"},children:\"Cancel\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"strong\",{children:t.title}),\" \\u2014 \",t.description,/*#__PURE__*/_jsx(\"button\",{onClick:()=>startEditing(t),style:{marginLeft:\"1rem\"},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteTask(t.id),style:{marginLeft:\"0.5rem\"},children:\"Delete\"})]})},t.id))}),/*#__PURE__*/_jsx(\"button\",{onClick:onLogout,style:{marginTop:\"2rem\"},children:\"Logout\"})]});}","map":{"version":3,"names":["React","useState","useEffect","api","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","Tasks","_ref","user","propUser","onLogout","task","setTask","description","setDescription","tasks","setTasks","editingId","setEditingId","editText","setEditText","token","localStorage","getItem","id","JSON","parse","console","warn","fetchTasks","res","get","headers","Authorization","concat","data","err","error","createTask","trim","alert","log","userId","payload","user_id","title","status","post","deleteTask","delete","filter","t","startEditing","cancelEditing","updateTask","put","map","style","padding","children","name","marginBottom","value","onChange","e","target","placeholder","width","marginLeft","onClick","marginTop"],"sources":["/Users/saniyaacharya/Desktop/3-tier-app-Deployment-1/frontend/src/Tasks.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport api from \"./services/api\";\n\nexport default function Tasks({ user: propUser, onLogout }) {\n  const [task, setTask] = useState(\"\");\n  const [description, setDescription] = useState(\"\");\n  const [tasks, setTasks] = useState([]);\n  const [editingId, setEditingId] = useState(null);\n  const [editText, setEditText] = useState(\"\");\n  const token = localStorage.getItem(\"token\");\n\n  // Ensure user is available even if prop is lost\n  const user = propUser?.id ? propUser : JSON.parse(localStorage.getItem(\"user\"));\n\n  useEffect(() => {\n    if (!user?.id) {\n      console.warn(\"User ID missing — redirecting to login\");\n      onLogout();\n    }\n  }, [user, onLogout]);\n\n  const fetchTasks = async () => {\n    try {\n      const res = await api.get(\"/tasks\", {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      setTasks(res.data);\n    } catch (err) {\n      console.error(\"Failed to fetch tasks:\", err);\n    }\n  };\n\n  const createTask = async () => {\n    if (!user?.id || !task.trim()) {\n      alert(\"User ID and task title are required\");\n      console.log(\"Debug:\", { userId: user?.id, task });\n      return;\n    }\n\n    const payload = {\n      user_id: user.id,\n      title: task,\n      description: description || \"\",\n      status: \"pending\"\n    };\n\n    try {\n      const res = await api.post(\"/tasks\", payload, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      setTasks([...tasks, res.data]);\n      setTask(\"\");\n      setDescription(\"\");\n    } catch (err) {\n      console.error(\"Failed to create task:\", err);\n      alert(\"❌ Task creation failed\");\n    }\n  };\n\n  const deleteTask = async (id) => {\n    try {\n      await api.delete(`/tasks/${id}`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      setTasks(tasks.filter((t) => t.id !== id));\n    } catch (err) {\n      console.error(\"Failed to delete task:\", err);\n    }\n  };\n\n  const startEditing = (task) => {\n    setEditingId(task.id);\n    setEditText(task.title);\n  };\n\n  const cancelEditing = () => {\n    setEditingId(null);\n    setEditText(\"\");\n  };\n\n  const updateTask = async () => {\n    try {\n      const res = await api.put(\n        `/tasks/${editingId}`,\n        { title: editText },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      setTasks(tasks.map((t) => (t.id === editingId ? res.data : t)));\n      cancelEditing();\n    } catch (err) {\n      console.error(\"Failed to update task:\", err);\n    }\n  };\n\n  useEffect(() => {\n    fetchTasks();\n  }, []);\n\n  return (\n    <div style={{ padding: \"2rem\" }}>\n      <h2>Welcome, {user?.name || \"User\"}</h2>\n\n      <div style={{ marginBottom: \"1rem\" }}>\n        <input\n          value={task}\n          onChange={(e) => setTask(e.target.value)}\n          placeholder=\"New task\"\n          style={{ padding: \"0.5rem\", width: \"300px\" }}\n        />\n        <input\n          value={description}\n          onChange={(e) => setDescription(e.target.value)}\n          placeholder=\"Description\"\n          style={{ padding: \"0.5rem\", width: \"300px\", marginLeft: \"1rem\" }}\n        />\n        <button onClick={createTask} style={{ marginLeft: \"1rem\" }}>\n          Add Task\n        </button>\n      </div>\n\n      <ul>\n        {tasks.map((t) => (\n          <li key={t.id} style={{ marginBottom: \"0.5rem\" }}>\n            {editingId === t.id ? (\n              <>\n                <input\n                  value={editText}\n                  onChange={(e) => setEditText(e.target.value)}\n                  style={{ padding: \"0.3rem\", width: \"250px\" }}\n                />\n                <button onClick={updateTask} style={{ marginLeft: \"0.5rem\" }}>\n                  Save\n                </button>\n                <button onClick={cancelEditing} style={{ marginLeft: \"0.5rem\" }}>\n                  Cancel\n                </button>\n              </>\n            ) : (\n              <>\n                <strong>{t.title}</strong> — {t.description}\n                <button onClick={() => startEditing(t)} style={{ marginLeft: \"1rem\" }}>\n                  Edit\n                </button>\n                <button onClick={() => deleteTask(t.id)} style={{ marginLeft: \"0.5rem\" }}>\n                  Delete\n                </button>\n              </>\n            )}\n          </li>\n        ))}\n      </ul>\n\n      <button onClick={onLogout} style={{ marginTop: \"2rem\" }}>\n        Logout\n      </button>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}